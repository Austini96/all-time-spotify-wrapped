{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2025-10-19T21:40:57.942856Z", "invocation_id": "c83fc19f-8e2e-437a-9de1-b066d8517e24", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.642380Z", "completed_at": "2025-10-19T21:40:57.653597Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.656432Z", "completed_at": "2025-10-19T21:40:57.656445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022836923599243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.stg_spotify_artists", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM raw_spotify_artists\n),\n\nranked AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (PARTITION BY artist_id ORDER BY loaded_at DESC) as rn\n    FROM source\n)\n\nSELECT\n    artist_id,\n    artist_name,\n    genres,\n    popularity,\n    followers,\n    loaded_at\nFROM ranked\nWHERE rn = 1", "relation_name": "\"spotify\".\"staging\".\"stg_spotify_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.647386Z", "completed_at": "2025-10-19T21:40:57.654680Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.657021Z", "completed_at": "2025-10-19T21:40:57.657027Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02086949348449707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.stg_spotify_audio_features", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM raw_spotify_audio_features\n),\n\nranked AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (PARTITION BY id ORDER BY loaded_at DESC) as rn\n    FROM source\n)\n\nSELECT\n    id as track_id,\n    danceability,\n    energy,\n    key,\n    loudness,\n    mode,\n    CASE mode\n        WHEN 0 THEN 'Minor'\n        WHEN 1 THEN 'Major'\n    END as mode_name,\n    speechiness,\n    acousticness,\n    instrumentalness,\n    liveness,\n    valence,\n    tempo,\n    duration_ms,\n    time_signature,\n    \n    -- Derive additional features\n    CASE\n        WHEN valence >= 0.7 AND energy >= 0.7 THEN 'Happy & Energetic'\n        WHEN valence >= 0.7 AND energy < 0.4 THEN 'Happy & Calm'\n        WHEN valence < 0.4 AND energy >= 0.7 THEN 'Sad & Energetic'\n        WHEN valence < 0.4 AND energy < 0.4 THEN 'Sad & Calm'\n        ELSE 'Neutral'\n    END as mood_category,\n    \n    loaded_at\nFROM ranked\nWHERE rn = 1", "relation_name": "\"spotify\".\"staging\".\"stg_spotify_audio_features\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.649351Z", "completed_at": "2025-10-19T21:40:57.655584Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.657975Z", "completed_at": "2025-10-19T21:40:57.657980Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022208213806152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.stg_spotify_playlist_tracks", "compiled": true, "compiled_code": "-- Staging model for Spotify playlist-track relationships\nWITH source AS (\n    SELECT *\n    FROM raw_spotify_playlist_tracks\n),\n\nrenamed AS (\n    SELECT\n        playlist_id,\n        track_id,\n        added_at,\n        added_by,\n        position,\n        loaded_at\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"spotify\".\"staging\".\"stg_spotify_playlist_tracks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.650800Z", "completed_at": "2025-10-19T21:40:57.656133Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.657656Z", "completed_at": "2025-10-19T21:40:57.657660Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024883031845092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.stg_spotify_playlists", "compiled": true, "compiled_code": "-- Staging model for Spotify playlists\nWITH source AS (\n    SELECT *\n    FROM raw_spotify_playlists\n),\n\nrenamed AS (\n    SELECT\n        playlist_id,\n        playlist_name,\n        owner_id,\n        is_owner,\n        is_public,\n        is_collaborative,\n        total_tracks,\n        description,\n        snapshot_id,\n        extracted_at,\n        loaded_at\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"spotify\".\"staging\".\"stg_spotify_playlists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.673925Z", "completed_at": "2025-10-19T21:40:57.687862Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.696668Z", "completed_at": "2025-10-19T21:40:57.696681Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024289608001708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_stg_spotify_artists_artist_id.9526077384", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    artist_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"staging\".\"stg_spotify_artists\"\nwhere artist_id is not null\ngroup by artist_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.665149Z", "completed_at": "2025-10-19T21:40:57.680254Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.692770Z", "completed_at": "2025-10-19T21:40:57.692786Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03714323043823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_artists_artist_id.68f8f61733", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_id\nfrom \"spotify\".\"staging\".\"stg_spotify_artists\"\nwhere artist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.681460Z", "completed_at": "2025-10-19T21:40:57.696169Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.699819Z", "completed_at": "2025-10-19T21:40:57.699842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03717494010925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.stg_spotify_tracks", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM raw_spotify_tracks\n),\n\ndeduplicated AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY track_id, played_at \n            ORDER BY loaded_at DESC\n        ) as rn\n    FROM source\n)\n\nSELECT\n    md5(cast(coalesce(cast(track_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(played_at as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as play_id,\n    played_at,\n    track_id,\n    track_name,\n    artist_id,\n    artist_name,\n    album_id,\n    album_name,\n    album_release_date,\n    CAST(SUBSTRING(album_release_date, 1, 4) AS INTEGER) as album_release_year,\n    duration_ms,\n    popularity,\n    explicit,\n    track_uri,\n    CAST(played_at AS DATE) as played_date,\n    EXTRACT(YEAR FROM played_at) as played_year,\n    EXTRACT(MONTH FROM played_at) as played_month,\n    EXTRACT(DAY FROM played_at) as played_day,\n    EXTRACT(HOUR FROM played_at) as played_hour,\n    EXTRACT(DOW FROM played_at) as played_day_of_week,\n    CASE EXTRACT(DOW FROM played_at)\n        WHEN 0 THEN 'Sunday'\n        WHEN 1 THEN 'Monday'\n        WHEN 2 THEN 'Tuesday'\n        WHEN 3 THEN 'Wednesday'\n        WHEN 4 THEN 'Thursday'\n        WHEN 5 THEN 'Friday'\n        WHEN 6 THEN 'Saturday'\n    END as played_day_name,\n    loaded_at\nFROM deduplicated\nWHERE rn = 1\n    AND duration_ms >= 30000", "relation_name": "\"spotify\".\"staging\".\"stg_spotify_tracks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.693435Z", "completed_at": "2025-10-19T21:40:57.699017Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.701208Z", "completed_at": "2025-10-19T21:40:57.701214Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02547311782836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_audio_features_track_id.e5b6b98713", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom \"spotify\".\"staging\".\"stg_spotify_audio_features\"\nwhere track_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.710788Z", "completed_at": "2025-10-19T21:40:57.717022Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.724686Z", "completed_at": "2025-10-19T21:40:57.724694Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0233457088470459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_stg_spotify_audio_features_track_id.f9abd68144", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    track_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"staging\".\"stg_spotify_audio_features\"\nwhere track_id is not null\ngroup by track_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.707828Z", "completed_at": "2025-10-19T21:40:57.717394Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.725812Z", "completed_at": "2025-10-19T21:40:57.725816Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026071548461914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_playlist_tracks_playlist_id.da27ed70a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect playlist_id\nfrom \"spotify\".\"staging\".\"stg_spotify_playlist_tracks\"\nwhere playlist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.717651Z", "completed_at": "2025-10-19T21:40:57.724970Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.729791Z", "completed_at": "2025-10-19T21:40:57.729800Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026121139526367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_playlist_tracks_track_id.fa40b0bff6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom \"spotify\".\"staging\".\"stg_spotify_playlist_tracks\"\nwhere track_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.720943Z", "completed_at": "2025-10-19T21:40:57.725569Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.730389Z", "completed_at": "2025-10-19T21:40:57.730394Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01735663414001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.dim_playlists", "compiled": true, "compiled_code": "-- Playlist dimension table with slowly changing dimensions (Type 1)\nWITH playlists AS (\n    SELECT *\n    FROM \"spotify\".\"staging\".\"stg_spotify_playlists\"\n),\n\nplaylist_stats AS (\n    -- Calculate actual track counts from playlist_tracks\n    SELECT\n        playlist_id,\n        COUNT(DISTINCT track_id) AS actual_track_count,\n        MIN(added_at) AS first_track_added,\n        MAX(added_at) AS last_track_added\n    FROM \"spotify\".\"staging\".\"stg_spotify_playlist_tracks\"\n    GROUP BY playlist_id\n),\n\nfinal AS (\n    SELECT\n        -- Surrogate key\n        MD5(p.playlist_id) AS playlist_sk,\n        \n        -- Natural key\n        p.playlist_id,\n        \n        -- Attributes\n        p.playlist_name,\n        p.owner_id,\n        p.is_owner,\n        p.is_public,\n        p.is_collaborative,\n        p.total_tracks AS reported_track_count,\n        COALESCE(ps.actual_track_count, 0) AS actual_track_count,\n        p.description,\n        ps.first_track_added,\n        ps.last_track_added,\n        \n        -- Metadata\n        p.snapshot_id,\n        p.extracted_at,\n        CURRENT_TIMESTAMP AS dbt_updated_at\n    FROM playlists p\n    LEFT JOIN playlist_stats ps ON p.playlist_id = ps.playlist_id\n)\n\nSELECT * FROM final", "relation_name": "\"spotify\".\"marts\".\"dim_playlists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.735287Z", "completed_at": "2025-10-19T21:40:57.743865Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.752368Z", "completed_at": "2025-10-19T21:40:57.752377Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023828983306884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_playlists_playlist_id.32ee69ba88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect playlist_id\nfrom \"spotify\".\"staging\".\"stg_spotify_playlists\"\nwhere playlist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.739647Z", "completed_at": "2025-10-19T21:40:57.750023Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.753127Z", "completed_at": "2025-10-19T21:40:57.753134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02365899085998535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_stg_spotify_playlists_playlist_id.91a0bee532", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    playlist_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"staging\".\"stg_spotify_playlists\"\nwhere playlist_id is not null\ngroup by playlist_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.747599Z", "completed_at": "2025-10-19T21:40:57.752680Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.757353Z", "completed_at": "2025-10-19T21:40:57.757359Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018726587295532227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.dim_artists", "compiled": true, "compiled_code": "\n\nWITH artist_stats AS (\n    SELECT\n        artist_id,\n        COUNT(*) as total_plays,\n        COUNT(DISTINCT track_id) as unique_tracks_played,\n        COUNT(DISTINCT played_date) as days_played,\n        MIN(played_at) as first_played_at,\n        MAX(played_at) as last_played_at,\n        SUM(duration_ms) as total_listen_time_ms\n    FROM \"spotify\".\"staging\".\"stg_spotify_tracks\"\n    GROUP BY artist_id\n)\n\nSELECT\n    a.artist_id,\n    a.artist_name,\n    a.genres,\n    a.popularity,\n    a.followers,\n    \n    -- Play statistics\n    s.total_plays,\n    s.unique_tracks_played,\n    s.days_played,\n    s.first_played_at,\n    s.last_played_at,\n    s.total_listen_time_ms,\n    ROUND(s.total_listen_time_ms / 3600000.0, 2) as total_listen_time_hours\n\nFROM \"spotify\".\"staging\".\"stg_spotify_artists\" a\nLEFT JOIN artist_stats s\n    ON a.artist_id = s.artist_id", "relation_name": "\"spotify\".\"marts\".\"dim_artists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.745202Z", "completed_at": "2025-10-19T21:40:57.751811Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.756609Z", "completed_at": "2025-10-19T21:40:57.756613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019863128662109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.dim_albums", "compiled": true, "compiled_code": "\n\nWITH album_stats AS (\n    SELECT\n        album_id,\n        COUNT(*) as total_plays,\n        COUNT(DISTINCT track_id) as unique_tracks_played,\n        COUNT(DISTINCT played_date) as days_played,\n        MIN(played_at) as first_played_at,\n        MAX(played_at) as last_played_at\n    FROM \"spotify\".\"staging\".\"stg_spotify_tracks\"\n    GROUP BY album_id\n)\n\nSELECT\n    t.album_id,\n    t.album_name,\n    t.artist_id,\n    t.artist_name,\n    t.album_release_date,\n    t.album_release_year,\n    \n    -- Album statistics\n    s.total_plays,\n    s.unique_tracks_played,\n    s.days_played,\n    s.first_played_at,\n    s.last_played_at\n\nFROM \"spotify\".\"staging\".\"stg_spotify_tracks\" t\nLEFT JOIN album_stats s\n    ON t.album_id = s.album_id\n\n-- Get most recent version of each album\nQUALIFY ROW_NUMBER() OVER (PARTITION BY t.album_id ORDER BY t.loaded_at DESC) = 1", "relation_name": "\"spotify\".\"marts\".\"dim_albums\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.763247Z", "completed_at": "2025-10-19T21:40:57.773862Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.779671Z", "completed_at": "2025-10-19T21:40:57.779685Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023743391036987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.dim_tracks", "compiled": true, "compiled_code": "\n\nWITH track_stats AS (\n    SELECT\n        track_id,\n        COUNT(*) as total_plays,\n        MIN(played_at) as first_played_at,\n        MAX(played_at) as last_played_at,\n        COUNT(DISTINCT played_date) as days_played\n    FROM \"spotify\".\"staging\".\"stg_spotify_tracks\"\n    GROUP BY track_id\n)\n\nSELECT\n    t.track_id,\n    t.track_name,\n    t.artist_id,\n    t.artist_name,\n    t.album_id,\n    t.album_name,\n    t.album_release_date,\n    t.album_release_year,\n    t.duration_ms,\n    t.popularity,\n    t.explicit,\n    \n    -- Audio features\n    af.danceability,\n    af.energy,\n    af.valence,\n    af.tempo,\n    af.acousticness,\n    af.instrumentalness,\n    af.speechiness,\n    af.liveness,\n    af.loudness,\n    af.mode_name,\n    af.mood_category,\n    \n    -- Play statistics\n    ts.total_plays,\n    ts.first_played_at,\n    ts.last_played_at,\n    ts.days_played\n\nFROM \"spotify\".\"staging\".\"stg_spotify_tracks\" t\nLEFT JOIN \"spotify\".\"staging\".\"stg_spotify_audio_features\" af\n    ON t.track_id = af.track_id\nLEFT JOIN track_stats ts\n    ON t.track_id = ts.track_id\n\n-- Get most recent version of each track\nQUALIFY ROW_NUMBER() OVER (PARTITION BY t.track_id ORDER BY t.loaded_at DESC) = 1", "relation_name": "\"spotify\".\"marts\".\"dim_tracks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.774204Z", "completed_at": "2025-10-19T21:40:57.780811Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.784419Z", "completed_at": "2025-10-19T21:40:57.784425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022554636001586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_tracks_play_id.32a01f499a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect play_id\nfrom \"spotify\".\"staging\".\"stg_spotify_tracks\"\nwhere play_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.767125Z", "completed_at": "2025-10-19T21:40:57.778029Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.781794Z", "completed_at": "2025-10-19T21:40:57.781797Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022600889205932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.fct_listening_history", "compiled": true, "compiled_code": "\n\nSELECT\n    t.play_id,\n    t.played_at,\n    t.played_date,\n    t.played_year,\n    t.played_month,\n    t.played_day,\n    t.played_hour,\n    t.played_day_of_week,\n    t.played_day_name,\n    \n    -- Track information\n    t.track_id,\n    t.track_name,\n    t.duration_ms,\n    t.popularity as track_popularity,\n    t.explicit,\n    t.track_uri,\n    \n    -- Artist information\n    t.artist_id,\n    t.artist_name,\n    a.genres as artist_genres,\n    a.popularity as artist_popularity,\n    a.followers as artist_followers,\n    \n    -- Album information\n    t.album_id,\n    t.album_name,\n    t.album_release_date,\n    t.album_release_year,\n    \n    -- Playlist information (if track was played from a playlist context)\n    -- Note: This requires context tracking which isn't available in recently_played API\n    -- For now, we'll add a reference to show which playlists contain this track\n    STRING_AGG(DISTINCT p.playlist_name, ', ') AS playlists_containing_track,\n    COUNT(DISTINCT pt.playlist_id) AS playlist_count,\n    \n    -- Audio features\n    af.danceability,\n    af.energy,\n    af.key,\n    af.loudness,\n    af.mode,\n    af.mode_name,\n    af.speechiness,\n    af.acousticness,\n    af.instrumentalness,\n    af.liveness,\n    af.valence,\n    af.tempo,\n    af.time_signature,\n    af.mood_category,\n    \n    -- Metadata\n    t.loaded_at\n\nFROM \"spotify\".\"staging\".\"stg_spotify_tracks\" t\nLEFT JOIN \"spotify\".\"staging\".\"stg_spotify_audio_features\" af\n    ON t.track_id = af.track_id\nLEFT JOIN \"spotify\".\"staging\".\"stg_spotify_artists\" a\n    ON t.artist_id = a.artist_id\nLEFT JOIN \"spotify\".\"staging\".\"stg_spotify_playlist_tracks\" pt\n    ON t.track_id = pt.track_id\nLEFT JOIN \"spotify\".\"staging\".\"stg_spotify_playlists\" p\n    ON pt.playlist_id = p.playlist_id\nGROUP BY\n    t.play_id,\n    t.played_at,\n    t.played_date,\n    t.played_year,\n    t.played_month,\n    t.played_day,\n    t.played_hour,\n    t.played_day_of_week,\n    t.played_day_name,\n    t.track_id,\n    t.track_name,\n    t.duration_ms,\n    t.popularity,\n    t.explicit,\n    t.track_uri,\n    t.artist_id,\n    t.artist_name,\n    a.genres,\n    a.popularity,\n    a.followers,\n    t.album_id,\n    t.album_name,\n    t.album_release_date,\n    t.album_release_year,\n    af.danceability,\n    af.energy,\n    af.key,\n    af.loudness,\n    af.mode,\n    af.mode_name,\n    af.speechiness,\n    af.acousticness,\n    af.instrumentalness,\n    af.liveness,\n    af.valence,\n    af.tempo,\n    af.time_signature,\n    af.mood_category,\n    t.loaded_at", "relation_name": "\"spotify\".\"marts\".\"fct_listening_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.771070Z", "completed_at": "2025-10-19T21:40:57.778974Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.781472Z", "completed_at": "2025-10-19T21:40:57.781477Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02562403678894043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_tracks_duration_ms.2ad9a7f609", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect duration_ms\nfrom \"spotify\".\"staging\".\"stg_spotify_tracks\"\nwhere duration_ms is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.799273Z", "completed_at": "2025-10-19T21:40:57.816823Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.820380Z", "completed_at": "2025-10-19T21:40:57.820390Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03357219696044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_tracks_played_at.afdeb41979", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect played_at\nfrom \"spotify\".\"staging\".\"stg_spotify_tracks\"\nwhere played_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.805923Z", "completed_at": "2025-10-19T21:40:57.817252Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.821841Z", "completed_at": "2025-10-19T21:40:57.821845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03409242630004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_stg_spotify_tracks_track_id.596853f1e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom \"spotify\".\"staging\".\"stg_spotify_tracks\"\nwhere track_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.809218Z", "completed_at": "2025-10-19T21:40:57.818899Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.823897Z", "completed_at": "2025-10-19T21:40:57.823901Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03604006767272949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_stg_spotify_tracks_play_id.2a338fc109", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    play_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"staging\".\"stg_spotify_tracks\"\nwhere play_id is not null\ngroup by play_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.813899Z", "completed_at": "2025-10-19T21:40:57.819422Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.823053Z", "completed_at": "2025-10-19T21:40:57.823056Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026634693145751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.playlist_analysis", "compiled": true, "compiled_code": "\n\n-- Playlist analysis with track listening statistics\nWITH playlist_tracks AS (\n    SELECT\n        p.playlist_id,\n        p.playlist_name,\n        p.is_owner,\n        p.is_public,\n        p.is_collaborative,\n        pt.track_id,\n        pt.added_at,\n        pt.position\n    FROM \"spotify\".\"marts\".\"dim_playlists\" p\n    INNER JOIN \"spotify\".\"staging\".\"stg_spotify_playlist_tracks\" pt\n        ON p.playlist_id = pt.playlist_id\n),\n\ntrack_plays AS (\n    SELECT\n        track_id,\n        COUNT(*) AS play_count,\n        MIN(played_at) AS first_played,\n        MAX(played_at) AS last_played\n    FROM \"spotify\".\"staging\".\"stg_spotify_tracks\"\n    GROUP BY track_id\n),\n\ntrack_details AS (\n    SELECT\n        t.track_id,\n        t.track_name,\n        t.artist_name,\n        t.album_name,\n        t.duration_ms,\n        af.valence,\n        af.energy,\n        af.danceability,\n        af.mood_category\n    FROM \"spotify\".\"staging\".\"stg_spotify_tracks\" t\n    LEFT JOIN \"spotify\".\"staging\".\"stg_spotify_audio_features\" af\n        ON t.track_id = af.track_id\n),\n\nplaylist_stats AS (\n    SELECT\n        pt.playlist_id,\n        pt.playlist_name,\n        pt.is_owner,\n        pt.is_public,\n        pt.is_collaborative,\n        \n        -- Track counts\n        COUNT(DISTINCT pt.track_id) AS total_tracks,\n        COUNT(DISTINCT CASE WHEN tp.play_count > 0 THEN pt.track_id END) AS played_tracks,\n        COUNT(DISTINCT CASE WHEN tp.play_count IS NULL THEN pt.track_id END) AS unplayed_tracks,\n        \n        -- Play statistics\n        SUM(COALESCE(tp.play_count, 0)) AS total_plays,\n        ROUND(AVG(COALESCE(tp.play_count, 0)), 2) AS avg_plays_per_track,\n        MAX(tp.play_count) AS max_plays,\n        \n        -- Audio features averages\n        ROUND(AVG(td.valence), 3) AS avg_valence,\n        ROUND(AVG(td.energy), 3) AS avg_energy,\n        ROUND(AVG(td.danceability), 3) AS avg_danceability,\n        \n        -- Timing\n        MIN(pt.added_at) AS first_track_added,\n        MAX(pt.added_at) AS last_track_added,\n        MIN(tp.first_played) AS first_play_date,\n        MAX(tp.last_played) AS last_play_date,\n        \n        -- Duration\n        ROUND(SUM(td.duration_ms) / 1000.0 / 60.0, 2) AS total_duration_minutes,\n        ROUND(AVG(td.duration_ms) / 1000.0 / 60.0, 2) AS avg_track_duration_minutes\n        \n    FROM playlist_tracks pt\n    LEFT JOIN track_plays tp ON pt.track_id = tp.track_id\n    LEFT JOIN track_details td ON pt.track_id = td.track_id\n    GROUP BY\n        pt.playlist_id,\n        pt.playlist_name,\n        pt.is_owner,\n        pt.is_public,\n        pt.is_collaborative\n)\n\nSELECT\n    playlist_id,\n    playlist_name,\n    is_owner,\n    is_public,\n    is_collaborative,\n    total_tracks,\n    played_tracks,\n    unplayed_tracks,\n    ROUND(100.0 * played_tracks / NULLIF(total_tracks, 0), 1) AS played_percentage,\n    total_plays,\n    avg_plays_per_track,\n    max_plays,\n    avg_valence,\n    avg_energy,\n    avg_danceability,\n    CASE\n        WHEN avg_valence >= 0.6 AND avg_energy >= 0.6 THEN 'Happy & Energetic'\n        WHEN avg_valence >= 0.6 AND avg_energy < 0.6 THEN 'Happy & Calm'\n        WHEN avg_valence < 0.4 AND avg_energy >= 0.6 THEN 'Sad & Energetic'\n        WHEN avg_valence < 0.4 AND avg_energy < 0.6 THEN 'Sad & Calm'\n        ELSE 'Neutral'\n    END AS playlist_mood,\n    total_duration_minutes,\n    avg_track_duration_minutes,\n    first_track_added,\n    last_track_added,\n    first_play_date,\n    last_play_date,\n    CURRENT_TIMESTAMP AS analyzed_at\nFROM playlist_stats\nORDER BY total_plays DESC, total_tracks DESC", "relation_name": "\"spotify\".\"analytics\".\"playlist_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.829166Z", "completed_at": "2025-10-19T21:40:57.837427Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.849331Z", "completed_at": "2025-10-19T21:40:57.849344Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02927374839782715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_dim_playlists_playlist_id.7b76cb1990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect playlist_id\nfrom \"spotify\".\"marts\".\"dim_playlists\"\nwhere playlist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.832899Z", "completed_at": "2025-10-19T21:40:57.842683Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.850012Z", "completed_at": "2025-10-19T21:40:57.850021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026682376861572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_dim_playlists_playlist_id.40022b465d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    playlist_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"marts\".\"dim_playlists\"\nwhere playlist_id is not null\ngroup by playlist_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.838272Z", "completed_at": "2025-10-19T21:40:57.848851Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.855748Z", "completed_at": "2025-10-19T21:40:57.855759Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027289867401123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_dim_artists_artist_id.73b124aa40", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    artist_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"marts\".\"dim_artists\"\nwhere artist_id is not null\ngroup by artist_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.846136Z", "completed_at": "2025-10-19T21:40:57.855324Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.857286Z", "completed_at": "2025-10-19T21:40:57.857289Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033046722412109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_dim_artists_artist_id.53f5a0d348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect artist_id\nfrom \"spotify\".\"marts\".\"dim_artists\"\nwhere artist_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.860843Z", "completed_at": "2025-10-19T21:40:57.873499Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.884367Z", "completed_at": "2025-10-19T21:40:57.884377Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026768207550048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_dim_albums_album_id.265f901b1a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    album_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"marts\".\"dim_albums\"\nwhere album_id is not null\ngroup by album_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.864689Z", "completed_at": "2025-10-19T21:40:57.876955Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.888865Z", "completed_at": "2025-10-19T21:40:57.888875Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03331494331359863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_dim_albums_album_id.0d51c5dd91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect album_id\nfrom \"spotify\".\"marts\".\"dim_albums\"\nwhere album_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.885855Z", "completed_at": "2025-10-19T21:40:57.892060Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.897641Z", "completed_at": "2025-10-19T21:40:57.897653Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022043466567993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_dim_tracks_track_id.d002244df5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    track_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"marts\".\"dim_tracks\"\nwhere track_id is not null\ngroup by track_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.878130Z", "completed_at": "2025-10-19T21:40:57.890403Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.892834Z", "completed_at": "2025-10-19T21:40:57.892839Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03536176681518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_dim_tracks_track_id.6e8a1f4a46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect track_id\nfrom \"spotify\".\"marts\".\"dim_tracks\"\nwhere track_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.895212Z", "completed_at": "2025-10-19T21:40:57.900843Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.909054Z", "completed_at": "2025-10-19T21:40:57.909062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018988609313964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.audio_features_analysis", "compiled": true, "compiled_code": "\n\nSELECT\n    played_date,\n    \n    -- Mood distribution\n    COUNT(CASE WHEN mood_category = 'Happy & Energetic' THEN 1 END) as happy_energetic_count,\n    COUNT(CASE WHEN mood_category = 'Happy & Calm' THEN 1 END) as happy_calm_count,\n    COUNT(CASE WHEN mood_category = 'Sad & Energetic' THEN 1 END) as sad_energetic_count,\n    COUNT(CASE WHEN mood_category = 'Sad & Calm' THEN 1 END) as sad_calm_count,\n    COUNT(CASE WHEN mood_category = 'Neutral' THEN 1 END) as neutral_count,\n    \n    -- Audio feature statistics\n    AVG(danceability) as avg_danceability,\n    AVG(energy) as avg_energy,\n    AVG(valence) as avg_valence,\n    AVG(tempo) as avg_tempo,\n    AVG(acousticness) as avg_acousticness,\n    AVG(instrumentalness) as avg_instrumentalness,\n    AVG(speechiness) as avg_speechiness,\n    AVG(liveness) as avg_liveness,\n    AVG(loudness) as avg_loudness,\n    \n    -- Feature ranges\n    MIN(energy) as min_energy,\n    MAX(energy) as max_energy,\n    MIN(valence) as min_valence,\n    MAX(valence) as max_valence,\n    MIN(tempo) as min_tempo,\n    MAX(tempo) as max_tempo,\n    \n    -- Mode distribution\n    COUNT(CASE WHEN mode_name = 'Major' THEN 1 END) as major_key_count,\n    COUNT(CASE WHEN mode_name = 'Minor' THEN 1 END) as minor_key_count,\n    \n    -- Explicit content\n    COUNT(CASE WHEN explicit THEN 1 END) as explicit_tracks_count,\n    ROUND(100.0 * COUNT(CASE WHEN explicit THEN 1 END) / COUNT(*), 2) as explicit_percentage\n\nFROM \"spotify\".\"marts\".\"fct_listening_history\"\nGROUP BY played_date\nORDER BY played_date DESC", "relation_name": "\"spotify\".\"analytics\".\"audio_features_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.902030Z", "completed_at": "2025-10-19T21:40:57.909410Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.915491Z", "completed_at": "2025-10-19T21:40:57.915498Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021676301956176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.listening_patterns_hourly", "compiled": true, "compiled_code": "\n\nSELECT\n    played_date,\n    played_hour,\n    played_day_of_week,\n    played_day_name,\n    \n    -- Volume metrics\n    COUNT(*) as play_count,\n    COUNT(DISTINCT track_id) as unique_tracks,\n    COUNT(DISTINCT artist_id) as unique_artists,\n    SUM(duration_ms) as total_listen_time_ms,\n    ROUND(SUM(duration_ms) / 60000.0, 2) as total_listen_time_minutes,\n    \n    -- Audio feature averages\n    AVG(energy) as avg_energy,\n    AVG(valence) as avg_valence,\n    AVG(danceability) as avg_danceability,\n    AVG(tempo) as avg_tempo,\n    AVG(acousticness) as avg_acousticness,\n    AVG(instrumentalness) as avg_instrumentalness,\n    AVG(speechiness) as avg_speechiness,\n    AVG(loudness) as avg_loudness,\n    \n    -- Most common mood\n    MODE() WITHIN GROUP (ORDER BY mood_category) as most_common_mood\n\nFROM \"spotify\".\"marts\".\"fct_listening_history\"\nGROUP BY \n    played_date,\n    played_hour,\n    played_day_of_week,\n    played_day_name\nORDER BY \n    played_date DESC,\n    played_hour", "relation_name": "\"spotify\".\"analytics\".\"listening_patterns_hourly\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.905786Z", "completed_at": "2025-10-19T21:40:57.910919Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.917237Z", "completed_at": "2025-10-19T21:40:57.917243Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019012928009033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_artists_daily", "compiled": true, "compiled_code": "\n\nSELECT\n    played_date,\n    artist_id,\n    artist_name,\n    artist_genres,\n    COUNT(*) as play_count,\n    COUNT(DISTINCT track_id) as unique_tracks_played,\n    SUM(duration_ms) as total_listen_time_ms,\n    ROUND(SUM(duration_ms) / 60000.0, 2) as total_listen_time_minutes,\n    AVG(track_popularity) as avg_track_popularity,\n    AVG(energy) as avg_energy,\n    AVG(valence) as avg_valence,\n    AVG(danceability) as avg_danceability,\n    MAX(artist_followers) as artist_followers\n\nFROM \"spotify\".\"marts\".\"fct_listening_history\"\nGROUP BY \n    played_date,\n    artist_id,\n    artist_name,\n    artist_genres\nORDER BY \n    played_date DESC,\n    play_count DESC", "relation_name": "\"spotify\".\"analytics\".\"top_artists_daily\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.912158Z", "completed_at": "2025-10-19T21:40:57.918869Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.925211Z", "completed_at": "2025-10-19T21:40:57.925218Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021413087844848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.spotify_analytics.top_tracks_daily", "compiled": true, "compiled_code": "\n\nSELECT\n    played_date,\n    track_id,\n    track_name,\n    artist_name,\n    album_name,\n    COUNT(*) as play_count,\n    MAX(track_popularity) as track_popularity,\n    MAX(duration_ms) as duration_ms,\n    MAX(explicit) as explicit,\n    AVG(energy) as avg_energy,\n    AVG(valence) as avg_valence,\n    AVG(danceability) as avg_danceability,\n    MAX(mood_category) as mood_category\n\nFROM \"spotify\".\"marts\".\"fct_listening_history\"\nGROUP BY \n    played_date,\n    track_id,\n    track_name,\n    artist_name,\n    album_name\nORDER BY \n    played_date DESC,\n    play_count DESC", "relation_name": "\"spotify\".\"analytics\".\"top_tracks_daily\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.920704Z", "completed_at": "2025-10-19T21:40:57.929130Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.934884Z", "completed_at": "2025-10-19T21:40:57.934891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020043134689331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.not_null_fct_listening_history_play_id.785f8250f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect play_id\nfrom \"spotify\".\"marts\".\"fct_listening_history\"\nwhere play_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.926346Z", "completed_at": "2025-10-19T21:40:57.934196Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.937163Z", "completed_at": "2025-10-19T21:40:57.937173Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013554096221923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.assert_positive_play_count", "compiled": true, "compiled_code": "-- Test to ensure all daily aggregations have positive play counts\nSELECT\n    played_date,\n    play_count\nFROM \"spotify\".\"analytics\".\"top_artists_daily\"\nWHERE play_count <= 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-19T21:40:57.930420Z", "completed_at": "2025-10-19T21:40:57.935830Z"}, {"name": "execute", "started_at": "2025-10-19T21:40:57.939016Z", "completed_at": "2025-10-19T21:40:57.939020Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015703439712524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.spotify_analytics.unique_fct_listening_history_play_id.8c47346a53", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    play_id as unique_field,\n    count(*) as n_records\n\nfrom \"spotify\".\"marts\".\"fct_listening_history\"\nwhere play_id is not null\ngroup by play_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.5767710208892822, "args": {"invocation_command": "dbt docs generate --profiles-dir .", "empty_catalog": false, "use_colors_file": true, "write_json": true, "profiles_dir": ".", "project_dir": "/opt/airflow/dbt_project", "quiet": false, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "printer_width": 80, "compile": true, "static": false, "defer": false, "log_path": "/opt/airflow/dbt_project/logs", "version_check": true, "indirect_selection": "eager", "log_format_file": "debug", "show_resource_report": false, "log_level": "info", "log_level_file": "debug", "cache_selected_only": false, "which": "generate", "use_colors": true, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "partial_parse": true, "log_format": "default", "favor_state": false, "print": true, "vars": {}, "strict_mode": false, "select": [], "introspect": true, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "static_parser": true, "exclude": [], "macro_debugging": false}}